{"content":"{\"__ud_title\":\"重新思考记账\",\"__ud_tags\":[],\"__ud_update_time\":1762745676684,\"__ud_create_time\":1762745675208,\"__ud_draft\":true,\"type\":\"doc\",\"content\":[{\"type\":\"heading\",\"attrs\":{\"level\":1,\"id\":null},\"content\":[{\"type\":\"text\",\"text\":\"重新思考记账\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"起因是在Cent的issues中看到一个关于增加多币种的请求，一开始我只是认为这或许是一个值得改进的Feature，甚至在构建Cent之初我就已经隐隐察觉到账单的数据结构中应该有一个字段用于记录币种，但当初并不觉得这对Cent的设计会有何影响，只是觉得后续可以通过迭代改进来加上这个功能。但是当我切实把Cent的功能都完善之后，我发现支持多币种这个需求，可能并没有我想象中的那么“自洽”。\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"这个困惑一直萦绕着我，于是我开始下载市面上其他的记账软件，想去看看它们对于多币种的处理方法。大多属记账软件似乎特意避开了多币种这一问题，它们像Cent一样只记录金额，而不关心币种。而另一些支持多币种的App，使用的方案却都让我感到不甚满意。\"}]},{\"type\":\"heading\",\"attrs\":{\"level\":2,\"id\":\"方案一实时汇率转换\"},\"content\":[{\"type\":\"text\",\"text\":\"实时汇率转换\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"以【随手记】为例，它支持多币种，实现的方式是在记账时直接将货币统一转换为默认货币，即通过查询汇率，实时地将每一笔支出转换为RMB，最终统计的时候，也只按照RMB的结果来进行统计，这样就避免了不同币种无法直接统计总支出的情况。这个方法十分简单，确实只需要加字段就可以解决，但是对于Cent来说，获取汇率依赖后端接口是一个极度不优雅的方式，因为Cent没有传统意义上的服务器，并且Cent的理念就是去服务器化，为了一个“特殊需求”而导致破坏这一理念，是Cent无法接受的。并且，即使是简单的使用，我也意识到了实时转换货币的不合理之处，首先是导入账单时，如果导入的是其他货币，那该如何处理汇率转换？因为货币的汇率是实时波动的，历史账单记录的金额很可能与导入时的汇率大相径庭，难道要基于历史的汇率去进行转换吗？这显然是不合理的。\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"老牌记账软件iCost也是这个思路，这更令我感到疑惑，难道这真的是多币种设计的唯一思路吗？\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"我开始思考几个涉及多币种的场景：\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"1，出门旅游，使用非本国货币支付。这种场景最为常见，我想起之前去香港旅游的经历，如今在外支付的方式已经十分便捷，使用支付宝和微信支付时，显示的支付结果已经是转换后的货币，即RMB，因此记录时只需要按照支付结果记录最终金额即可，并不涉及汇率问题。\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"2，长期在外，身上有多个币种的银行卡，每次支付时可能使用不同的卡片进行支付，支付结果显示的是卡对应的币种，不能直接换算。不过这种场景，我认为应该属于多账本功能，因为每个不同的币种其实都可以看作是一本账本，它们的本来就应该被分别记录在不同的账本里，这样账目才会更加清晰，统计支出时也会更有目的性。而Cent天然就支持多账本，似乎这样的场景已经能被覆盖了。\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"我突然意识到了一件事，虽然Cent支持了多账本，但是账本直接并没有什么联动，每个账本都是完全独立的，这可能才是用户想要多币种的原因\"}]},{\"type\":\"paragraph\"}]}","title":"重新思考记账","tags":[],"updateTime":1762745676684,"createTime":1762745675208,"draft":true,"intro":"起因是在Cent的issues中看到一个关于增加多币种的请求，一开始我只是认为这或许是一个值得改进的Feature，甚至在构建Cent之初我就已经隐隐察觉到账单的数据结构中应该有一个字段用于记录币种，但当初并不觉得这对Cent的设计会有何影响，只是觉得后续可以通过迭代改进来加上这个功能。但是当我切实把Cent的功能都完善之后，我发现支持多币种这个需求，可能并没有我想象中的那么“自洽”。","html":"<h1 level=\"1\" id=\"重新思考记账\">重新思考记账</h1><p>起因是在Cent的issues中看到一个关于增加多币种的请求，一开始我只是认为这或许是一个值得改进的Feature，甚至在构建Cent之初我就已经隐隐察觉到账单的数据结构中应该有一个字段用于记录币种，但当初并不觉得这对Cent的设计会有何影响，只是觉得后续可以通过迭代改进来加上这个功能。但是当我切实把Cent的功能都完善之后，我发现支持多币种这个需求，可能并没有我想象中的那么“自洽”。</p><p>这个困惑一直萦绕着我，于是我开始下载市面上其他的记账软件，想去看看它们对于多币种的处理方法。大多属记账软件似乎特意避开了多币种这一问题，它们像Cent一样只记录金额，而不关心币种。而另一些支持多币种的App，使用的方案却都让我感到不甚满意。</p><h2 level=\"2\" id=\"实时汇率转换\">实时汇率转换</h2><p>以【随手记】为例，它支持多币种，实现的方式是在记账时直接将货币统一转换为默认货币，即通过查询汇率，实时地将每一笔支出转换为RMB，最终统计的时候，也只按照RMB的结果来进行统计，这样就避免了不同币种无法直接统计总支出的情况。这个方法十分简单，确实只需要加字段就可以解决，但是对于Cent来说，获取汇率依赖后端接口是一个极度不优雅的方式，因为Cent没有传统意义上的服务器，并且Cent的理念就是去服务器化，为了一个“特殊需求”而导致破坏这一理念，是Cent无法接受的。并且，即使是简单的使用，我也意识到了实时转换货币的不合理之处，首先是导入账单时，如果导入的是其他货币，那该如何处理汇率转换？因为货币的汇率是实时波动的，历史账单记录的金额很可能与导入时的汇率大相径庭，难道要基于历史的汇率去进行转换吗？这显然是不合理的。</p><p>老牌记账软件iCost也是这个思路，这更令我感到疑惑，难道这真的是多币种设计的唯一思路吗？</p><p>我开始思考几个涉及多币种的场景：</p><p>1，出门旅游，使用非本国货币支付。这种场景最为常见，我想起之前去香港旅游的经历，如今在外支付的方式已经十分便捷，使用支付宝和微信支付时，显示的支付结果已经是转换后的货币，即RMB，因此记录时只需要按照支付结果记录最终金额即可，并不涉及汇率问题。</p><p>2，长期在外，身上有多个币种的银行卡，每次支付时可能使用不同的卡片进行支付，支付结果显示的是卡对应的币种，不能直接换算。不过这种场景，我认为应该属于多账本功能，因为每个不同的币种其实都可以看作是一本账本，它们的本来就应该被分别记录在不同的账本里，这样账目才会更加清晰，统计支出时也会更有目的性。而Cent天然就支持多账本，似乎这样的场景已经能被覆盖了。</p><p>我突然意识到了一件事，虽然Cent支持了多账本，但是账本直接并没有什么联动，每个账本都是完全独立的，这可能才是用户想要多币种的原因</p><p></p><script type=\"module\">const injectHtml = (root, html) => {\n  const iframe = document.createElement(\"iframe\");\n  const htmlContent = `<html><head></head><body>${html}</body></html>`;\n  iframe.style.width = \"100%\";\n  iframe.style.height = \"100%\";\n  iframe.onload = () => {\n    const doc = iframe.contentDocument || iframe.contentWindow?.document;\n    if (!doc) {\n      return;\n    }\n    doc.open();\n    doc.write(htmlContent);\n    doc.close();\n  };\n  root.replaceChildren(iframe);\n}\n  document.querySelectorAll('.playground')?.forEach(el=>{\n    const html = el.getAttribute('data-html');\n    if (html) {\n      injectHtml(el,html);\n    }\n    const indicator = document.createElement(\"div\");\n    indicator.className = \"indicator\";\n    const showCode = document.createElement(\"div\");\n    showCode.className = \"show-code\";\n    showCode.innerText = \"code\";\n    showCode.onclick = () => {\n      el.parentElement.classList.remove(\"preview-only\");\n    };\n    const showPreview = document.createElement(\"div\");\n    showPreview.className = \"show-preview\";\n    showPreview.innerText = \"preview\";\n    showPreview.onclick = () => {\n      el.parentElement.classList.add(\"preview-only\");\n    };\n    indicator.appendChild(showCode);\n    indicator.appendChild(showPreview);\n    el.parentElement.appendChild(indicator);\n    if (window.screen.width < 768) {\n      showPreview.click();\n    }\n  });</script>","id":"重新思考记账","path":"/posts/重新思考记账.json"}