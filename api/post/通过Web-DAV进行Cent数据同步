{"content":"{\"__ud_title\":\"通过Web DAV进行Cent数据同步\",\"__ud_tags\":[\"Cent\"],\"__ud_update_time\":1761900167185,\"__ud_create_time\":1761729435703,\"__ud_draft\":false,\"type\":\"doc\",\"content\":[{\"type\":\"heading\",\"attrs\":{\"level\":1,\"id\":\"通过Web-DAV进行Cent数据同步\"},\"content\":[{\"type\":\"text\",\"text\":\"通过Web DAV进行Cent数据同步\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"Cent现在支持通过Web DAV进行数据同步了，现在你可以把数据放到任何一个支持Web DAV协议的第三方存储服务提供商中，包括自建NAS，坚果云等。\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"在登录界面选择Web DAV，就可以进行对应的配置。\"}]},{\"type\":\"heading\",\"attrs\":{\"level\":2,\"id\":\"使用代理\"},\"content\":[{\"type\":\"text\",\"text\":\"CORS限制\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"由于浏览器同源策略(CORS)的限制，如果Web DAV服务没有返回相应的请求头，那么Cent将无法连接到Web DAV，所以请务必确认自己的Web DAV是否支持配置cors服务，并且将以下域名设置为允许跨域访问：\"}]},{\"type\":\"codeBlock\",\"attrs\":{\"language\":\"bash\"},\"content\":[{\"type\":\"text\",\"text\":\"https://cent.linkai.work\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"如果是私有部署Cent，需要将上面的域名替换为自己的域名。\"}]},{\"type\":\"heading\",\"attrs\":{\"level\":3,\"id\":\"私人NAS\"},\"content\":[{\"type\":\"text\",\"text\":\"私人NAS & 自建云服务\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"私人NAS一般都可以通过控制对外开放端口服务进行cors的配置，请咨询AI或者搜索相关方法开启跨域访问。\"}]},{\"type\":\"heading\",\"attrs\":{\"level\":3,\"id\":\"代理服务\"},\"content\":[{\"type\":\"text\",\"text\":\"使用代理\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"如果Web DAV服务器无法配置跨域，也可以通过第三方代理服务器进行中转，解除跨域限制。但是\"},{\"type\":\"text\",\"marks\":[{\"type\":\"bold\"}],\"text\":\"注意不要使用任何不受信任的第三方服务！\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"如果使用代理转发，那么所有数据包括Web DAV账号和密码都会被代理服务器获取，会导致十分严重的数据安全问题，所以请务必使用值得信任的代理服务器，例如自建代理服务器，所有其他代理服务方式都无法完全信任。\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"如果只是想尝试Web DAV，可以创建一个临时账户和密码，通过Cent提供的免费代理服务地址（by Cloudflare Workers）\"},{\"type\":\"text\",\"marks\":[{\"type\":\"code\"}],\"text\":\"https://cent-backend.linkai.work/proxy?url=\"},{\"type\":\"text\",\"text\":\" ，该服务\"},{\"type\":\"text\",\"marks\":[{\"type\":\"link\",\"attrs\":{\"href\":\"https://github.com/glink25/cent-github-backend\",\"target\":\"_blank\",\"rel\":\"noreferer\",\"class\":null}}],\"text\":\"完全开源\"},{\"type\":\"text\",\"text\":\"，并且承诺绝不会收集任何代理信息，但是依然不能“完全信任”，请确保使用该服务时使用临时账号，并在使用完服务后注销临时账号。\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"Cent通过简单拼接的方式使用代理URL：\"}]},{\"type\":\"codeBlock\",\"attrs\":{\"language\":\"javascript\"},\"content\":[{\"type\":\"text\",\"text\":\"// 假设原始请求为：\\nfetch('https://my-web-dav/dav/',{\\n\\tmethod: 'post'\\n})\\n// 假设填写的代理地址为\\nconst proxy ='https://cent-backend.linkai.work/proxy?url='\\n// 最终请求将变为：\\nfetch(`https://cent-backend.linkai.work/proxy?url=${encodeURIComponent('https://my-web-dav/dav/')}`,{\\n\\tmethod: 'post'\\n})\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"在使用自建代理时，如果代理服务器不允许例如PROFIND之类的非常见请求，可以尝试在填写代理地址时加上空的method参数，这样Cent将会自动为代码添加method参数兼容，即优先通过参数中的method进行代理转发，然后再降级为真实的method，例如：\"}]},{\"type\":\"codeBlock\",\"attrs\":{\"language\":\"javascript\"},\"content\":[{\"type\":\"text\",\"text\":\"// 假设原始请求为：\\nfetch('https://my-web-dav/dav/',{\\n\\tmethod: 'PROFIND'\\n})\\n// 假设填写的代理地址如下，注意增加了空的method参数\\nconst proxy ='https://cent-backend.linkai.work/proxy?method=&url='\\n// 最终请求将变为如下，请求将始终以post模式发出，在url中会携带真实的请求方式 ?method=PROFIND\\nfetch(`https://cent-backend.linkai.work/proxy?url=${encodeURIComponent('https://my-web-dav/dav/')}&method=PROFIND`,{\\n\\tmethod: 'post'\\n})\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"代理服务器中的代码需要手动兼容这种变化。（该特性主要是为了兼容部分免费Serverless服务，厂商可能会屏蔽某些不常见的请求方式，例如Cloudflare Workers）\"}]},{\"type\":\"heading\",\"attrs\":{\"level\":3,\"id\":\"坚果云\"},\"content\":[{\"type\":\"text\",\"text\":\"坚果云\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"由于未知原因，坚果云官方服务不支持Cloudflare Workers访问，因此无法通过Cent免费代理服务进行CORS绕过，必须使用自建代理服务器。\"}]},{\"type\":\"paragraph\"},{\"type\":\"heading\",\"attrs\":{\"level\":2,\"id\":\"自定义用户\"},\"content\":[{\"type\":\"text\",\"text\":\"自定义用户\"}]},{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"Cent支持多用户模式，即可以在使用同一个NAS账号时，切换为不同的“小号”，这一点主要是方便多人协作记账，部分Web DAV可能不支持共享同一个文件夹给其他用户，或者操作比较繁琐，通过自定义用户功能，同一个Web DAV账号可以根据用户名变为不同的“用户”，快速实现多人协同记账。\"}]}]}","title":"通过Web DAV进行Cent数据同步","tags":["Cent"],"updateTime":1761900167185,"createTime":1761729435703,"draft":false,"intro":"Cent现在支持通过Web DAV进行数据同步了，现在你可以把数据放到任何一个支持Web DAV协议的第三方存储服务提供商中，包括自建NAS，坚果云等。","html":"<h1 level=\"1\" id=\"通过Web-DAV进行Cent数据同步\">通过Web DAV进行Cent数据同步</h1><p>Cent现在支持通过Web DAV进行数据同步了，现在你可以把数据放到任何一个支持Web DAV协议的第三方存储服务提供商中，包括自建NAS，坚果云等。</p><p>在登录界面选择Web DAV，就可以进行对应的配置。</p><h2 level=\"2\" id=\"CORS限制\">CORS限制</h2><p>由于浏览器同源策略(CORS)的限制，如果Web DAV服务没有返回相应的请求头，那么Cent将无法连接到Web DAV，所以请务必确认自己的Web DAV是否支持配置cors服务，并且将以下域名设置为允许跨域访问：</p><div class=\"llt-code readonly\"><div class=\"language\">bash</div><div class=\"wrapper\"><pre><code class=\"language-bash\">https://cent.linkai.work</code></pre></div></div><p>如果是私有部署Cent，需要将上面的域名替换为自己的域名。</p><h3 level=\"3\" id=\"私人NAS--自建云服务\">私人NAS &amp; 自建云服务</h3><p>私人NAS一般都可以通过控制对外开放端口服务进行cors的配置，请咨询AI或者搜索相关方法开启跨域访问。</p><h3 level=\"3\" id=\"使用代理\">使用代理</h3><p>如果Web DAV服务器无法配置跨域，也可以通过第三方代理服务器进行中转，解除跨域限制。但是<strong>注意不要使用任何不受信任的第三方服务！</strong></p><p>如果使用代理转发，那么所有数据包括Web DAV账号和密码都会被代理服务器获取，会导致十分严重的数据安全问题，所以请务必使用值得信任的代理服务器，例如自建代理服务器，所有其他代理服务方式都无法完全信任。</p><p>如果只是想尝试Web DAV，可以创建一个临时账户和密码，通过Cent提供的免费代理服务地址（by Cloudflare Workers）<code>https://cent-backend.linkai.work/proxy?url=</code> ，该服务<a target=\"_blank\" rel=\"noreferer\" href=\"https://github.com/glink25/cent-github-backend\">完全开源</a>，并且承诺绝不会收集任何代理信息，但是依然不能“完全信任”，请确保使用该服务时使用临时账号，并在使用完服务后注销临时账号。</p><p>Cent通过简单拼接的方式使用代理URL：</p><div class=\"llt-code readonly\"><div class=\"language\">javascript</div><div class=\"wrapper\"><pre><code class=\"language-javascript\"><span class=\"hljs-comment\" class=\"hljs-comment\">// 假设原始请求为：</span>\n<span class=\"hljs-title,function_\" class=\"hljs-title,function_\">fetch</span>(<span class=\"hljs-string\" class=\"hljs-string\">&apos;https://my-web-dav/dav/&apos;</span>,{\n\t<span class=\"hljs-attr\" class=\"hljs-attr\">method</span>: <span class=\"hljs-string\" class=\"hljs-string\">&apos;post&apos;</span>\n})\n<span class=\"hljs-comment\" class=\"hljs-comment\">// 假设填写的代理地址为</span>\n<span class=\"hljs-keyword\" class=\"hljs-keyword\">const</span> proxy =<span class=\"hljs-string\" class=\"hljs-string\">&apos;https://cent-backend.linkai.work/proxy?url=&apos;</span>\n<span class=\"hljs-comment\" class=\"hljs-comment\">// 最终请求将变为：</span>\n<span class=\"hljs-title,function_\" class=\"hljs-title,function_\">fetch</span>(<span class=\"hljs-string\" class=\"hljs-string\">`https://cent-backend.linkai.work/proxy?url=<span class=\"hljs-subst\" class=\"hljs-subst\">${<span class=\"hljs-built_in\" class=\"hljs-built_in\">encodeURIComponent</span>(<span class=\"hljs-string\" class=\"hljs-string\">&apos;https://my-web-dav/dav/&apos;</span>)}</span>`</span>,{\n\t<span class=\"hljs-attr\" class=\"hljs-attr\">method</span>: <span class=\"hljs-string\" class=\"hljs-string\">&apos;post&apos;</span>\n})</code></pre></div></div><p>在使用自建代理时，如果代理服务器不允许例如PROFIND之类的非常见请求，可以尝试在填写代理地址时加上空的method参数，这样Cent将会自动为代码添加method参数兼容，即优先通过参数中的method进行代理转发，然后再降级为真实的method，例如：</p><div class=\"llt-code readonly\"><div class=\"language\">javascript</div><div class=\"wrapper\"><pre><code class=\"language-javascript\"><span class=\"hljs-comment\" class=\"hljs-comment\">// 假设原始请求为：</span>\n<span class=\"hljs-title,function_\" class=\"hljs-title,function_\">fetch</span>(<span class=\"hljs-string\" class=\"hljs-string\">&apos;https://my-web-dav/dav/&apos;</span>,{\n\t<span class=\"hljs-attr\" class=\"hljs-attr\">method</span>: <span class=\"hljs-string\" class=\"hljs-string\">&apos;PROFIND&apos;</span>\n})\n<span class=\"hljs-comment\" class=\"hljs-comment\">// 假设填写的代理地址如下，注意增加了空的method参数</span>\n<span class=\"hljs-keyword\" class=\"hljs-keyword\">const</span> proxy =<span class=\"hljs-string\" class=\"hljs-string\">&apos;https://cent-backend.linkai.work/proxy?method=&amp;url=&apos;</span>\n<span class=\"hljs-comment\" class=\"hljs-comment\">// 最终请求将变为如下，请求将始终以post模式发出，在url中会携带真实的请求方式 ?method=PROFIND</span>\n<span class=\"hljs-title,function_\" class=\"hljs-title,function_\">fetch</span>(<span class=\"hljs-string\" class=\"hljs-string\">`https://cent-backend.linkai.work/proxy?url=<span class=\"hljs-subst\" class=\"hljs-subst\">${<span class=\"hljs-built_in\" class=\"hljs-built_in\">encodeURIComponent</span>(<span class=\"hljs-string\" class=\"hljs-string\">&apos;https://my-web-dav/dav/&apos;</span>)}</span>&amp;method=PROFIND`</span>,{\n\t<span class=\"hljs-attr\" class=\"hljs-attr\">method</span>: <span class=\"hljs-string\" class=\"hljs-string\">&apos;post&apos;</span>\n})</code></pre></div></div><p>代理服务器中的代码需要手动兼容这种变化。（该特性主要是为了兼容部分免费Serverless服务，厂商可能会屏蔽某些不常见的请求方式，例如Cloudflare Workers）</p><h3 level=\"3\" id=\"坚果云\">坚果云</h3><p>由于未知原因，坚果云官方服务不支持Cloudflare Workers访问，因此无法通过Cent免费代理服务进行CORS绕过，必须使用自建代理服务器。</p><p></p><h2 level=\"2\" id=\"自定义用户\">自定义用户</h2><p>Cent支持多用户模式，即可以在使用同一个NAS账号时，切换为不同的“小号”，这一点主要是方便多人协作记账，部分Web DAV可能不支持共享同一个文件夹给其他用户，或者操作比较繁琐，通过自定义用户功能，同一个Web DAV账号可以根据用户名变为不同的“用户”，快速实现多人协同记账。</p><script type=\"module\">const injectHtml = (root, html) => {\n  const iframe = document.createElement(\"iframe\");\n  const htmlContent = `<html><head></head><body>${html}</body></html>`;\n  iframe.style.width = \"100%\";\n  iframe.style.height = \"100%\";\n  iframe.onload = () => {\n    const doc = iframe.contentDocument || iframe.contentWindow?.document;\n    if (!doc) {\n      return;\n    }\n    doc.open();\n    doc.write(htmlContent);\n    doc.close();\n  };\n  root.replaceChildren(iframe);\n}\n  document.querySelectorAll('.playground')?.forEach(el=>{\n    const html = el.getAttribute('data-html');\n    if (html) {\n      injectHtml(el,html);\n    }\n    const indicator = document.createElement(\"div\");\n    indicator.className = \"indicator\";\n    const showCode = document.createElement(\"div\");\n    showCode.className = \"show-code\";\n    showCode.innerText = \"code\";\n    showCode.onclick = () => {\n      el.parentElement.classList.remove(\"preview-only\");\n    };\n    const showPreview = document.createElement(\"div\");\n    showPreview.className = \"show-preview\";\n    showPreview.innerText = \"preview\";\n    showPreview.onclick = () => {\n      el.parentElement.classList.add(\"preview-only\");\n    };\n    indicator.appendChild(showCode);\n    indicator.appendChild(showPreview);\n    el.parentElement.appendChild(indicator);\n    if (window.screen.width < 768) {\n      showPreview.click();\n    }\n  });</script>","id":"通过Web-DAV进行Cent数据同步","path":"/posts/通过Web-DAV进行Cent数据同步.json"}