{"__ud_title":"如何使用 Github Actions 自动构建静态页面并部署在 Github Pages 上","__ud_tags":[],"__ud_update_time":1731893808715,"__ud_create_time":1731893807834,"__ud_draft":false,"type":"doc","content":[{"type":"heading","attrs":{"level":2},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"如何使用 Github Actions 自动构建静态页面并部署在 Github Pages 上"}]},{"type":"heading","attrs":{"level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"本地配置"}]},{"type":"paragraph","content":[{"type":"text","text":"在本地项目中新建文件夹 "},{"type":"text","marks":[{"type":"code"}],"text":".github/workflows"}]},{"type":"paragraph","content":[{"type":"text","text":"在 "},{"type":"text","marks":[{"type":"code"}],"text":"workflows"},{"type":"text","text":" 文件夹中新建 "},{"type":"text","marks":[{"type":"code"}],"text":"main.yml"},{"type":"text","text":"，用于配置 github actions，内容如下"}]},{"type":"codeBlock","attrs":{"language":"yaml"},"content":[{"type":"text","text":"name: GitHub Actions Build and Deploy\non:\n  push:\n    branches:\n      - main\njobs:\n  build-and-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout 🛎️\n        uses: actions/checkout@v2.3.1\n        with:\n          persist-credentials: false\n\n      - name: Install and Build 🔧\n        run: |\n          npm install\n          npm run build\n      - name: Deploy 🚀\n        uses: JamesIves/github-pages-deploy-action@3.7.1\n        with:\n          ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}\n          BRANCH: gh-pages\n          FOLDER: dist\n          CLEAN: true\n"}]},{"type":"heading","attrs":{"level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Github 配置"}]},{"type":"paragraph","content":[{"type":"text","text":"新建仓库"}]},{"type":"paragraph","content":[{"type":"text","text":"打开"},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://github.com/settings/tokens","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"Personal access tokens ("},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://github.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"github.com"},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://github.com/settings/tokens","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":")"},{"type":"text","text":"，点击 "},{"type":"text","marks":[{"type":"code"}],"text":"generate new token"},{"type":"text","text":" 按钮，为按钮添加备注（note），例如 "},{"type":"text","marks":[{"type":"code"}],"text":"github-actions-deploy"},{"type":"text","text":"，勾选 "},{"type":"text","marks":[{"type":"code"}],"text":"repos"},{"type":"text","text":" 选项，然后点击完成，跳转后的页面会有一个 key 显示出来，这个 key 只会在这里显示一次，以后就看不到了，复制这个 key 备用。"}]},{"type":"paragraph","content":[{"type":"text","text":"在新建的仓库 Settings 中选择 secrets->actions，点击 new repository secret，Name 填 ACCESS_TOKEN，value 填刚刚复制的 key，然后保存即可。"}]},{"type":"heading","attrs":{"level":3},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"部署"}]},{"type":"paragraph","content":[{"type":"text","text":"按照 github 仓库的提示将本地 git 项目上传至 github，点击 actions，会发现有两个 workflow，另一个是 github 自带的 github pages 部署用的 workflow "},{"type":"text","marks":[{"type":"code"}],"text":"pages-build-deployment"},{"type":"text","text":"，可能会部署失败，需要跳转至仓库 Setting->Pages，将项目 Source 改为 "},{"type":"text","marks":[{"type":"code"}],"text":"gh-pages"},{"type":"text","text":"，文件夹选择 root，回到 actions 页面，会发现 workflow 重新运行，稍等一会就能在 github pages 地址中访问看到部署的静态页面了。"}]}]}